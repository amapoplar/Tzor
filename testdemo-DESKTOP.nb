(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     71449,       1895]
NotebookOptionsPosition[     66431,       1806]
NotebookOutlinePosition[     66877,       1824]
CellTagsIndexPosition[     66834,       1821]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.8875414120867834`*^9},ExpressionUUID->"348dcfdd-f9aa-4a50-ab46-\
7eefe36073fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</tzor/tzor.m\>\""}], 
  "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"4ca7e658-21bf-477b-bd8c-699d87299747"],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\" Tz\[OAcute]r for \"\>", "\[InvisibleSpace]", 
    StyleBox["\<\"T\"\>",
     StripOnInput->False,
     LineColor->RGBColor[1, 0, 0],
     FrontFaceColor->RGBColor[1, 0, 0],
     BackFaceColor->RGBColor[1, 0, 0],
     GraphicsColor->RGBColor[1, 0, 0],
     FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", "\<\"heori\"\>", 
    "\[InvisibleSpace]", 
    StyleBox["\<\"z\"\>",
     StripOnInput->False,
     LineColor->RGBColor[1, 0, 0],
     FrontFaceColor->RGBColor[1, 0, 0],
     BackFaceColor->RGBColor[1, 0, 0],
     GraphicsColor->RGBColor[1, 0, 0],
     FontColor->RGBColor[1, 0, 0]], 
    "\[InvisibleSpace]", "\<\"ed package \"\>", "\[InvisibleSpace]", 
    StyleBox["\<\"o\"\>",
     StripOnInput->False,
     LineColor->RGBColor[1, 0, 0],
     FrontFaceColor->RGBColor[1, 0, 0],
     BackFaceColor->RGBColor[1, 0, 0],
     GraphicsColor->RGBColor[1, 0, 0],
     FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", "\<\"f sum \"\>", 
    "\[InvisibleSpace]", 
    StyleBox["\<\"r\"\>",
     StripOnInput->False,
     LineColor->RGBColor[1, 0, 0],
     FrontFaceColor->RGBColor[1, 0, 0],
     BackFaceColor->RGBColor[1, 0, 0],
     GraphicsColor->RGBColor[1, 0, 0],
     FontColor->RGBColor[1, 0, 0]], "\[InvisibleSpace]", "\<\"ules.\"\>"}],
   SequenceForm[" Tz\[OAcute]r for ", 
    Style["T", 
     RGBColor[1, 0, 0]], "heori", 
    Style["z", 
     RGBColor[1, 0, 0]], "ed package ", 
    Style["o", 
     RGBColor[1, 0, 0]], "f sum ", 
    Style["r", 
     RGBColor[1, 0, 0]], "ules."],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{
  3.8875253388860826`*^9, 3.88753194881915*^9, 3.8875425315013337`*^9, 
   3.887596001145379*^9, 3.887624039301811*^9, 3.8876763438817015`*^9, {
   3.88778931438058*^9, 3.8877893287007446`*^9}, {3.887795529852466*^9, 
   3.8877955709915714`*^9}},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"cfe176cc-ce5d-4d21-938f-\
1e596bcfa468"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\" Get Lastest Version : \"\>", "\[InvisibleSpace]", 
    TemplateBox[{"\"Tzor@github\"", "https://github.com/amapoplar/Tzor"},
     "HyperlinkURL"]}],
   SequenceForm[" Get Lastest Version : ", 
    Hyperlink["Tzor@github", "https://github.com/amapoplar/Tzor"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{
  3.8875253388860826`*^9, 3.88753194881915*^9, 3.8875425315013337`*^9, 
   3.887596001145379*^9, 3.887624039301811*^9, 3.8876763438817015`*^9, {
   3.88778931438058*^9, 3.8877893287007446`*^9}, {3.887795529852466*^9, 
   3.887795571031581*^9}},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"366a2de7-0ac3-4c16-bc2c-\
151fbe956a5e"],

Cell[BoxData[
 FormBox["\<\" Author : poplar, xlchen, zzchen, dklian\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{
  3.8875253388860826`*^9, 3.88753194881915*^9, 3.8875425315013337`*^9, 
   3.887596001145379*^9, 3.887624039301811*^9, 3.8876763438817015`*^9, {
   3.88778931438058*^9, 3.8877893287007446`*^9}, {3.887795529852466*^9, 
   3.887795571046722*^9}},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"00d67eff-09e4-48ea-bc97-\
ce8bd1e5dd92"],

Cell[BoxData[
 FormBox["\<\" Version : alpha \"\>", TraditionalForm]], "Print",
 CellChangeTimes->{
  3.8875253388860826`*^9, 3.88753194881915*^9, 3.8875425315013337`*^9, 
   3.887596001145379*^9, 3.887624039301811*^9, 3.8876763438817015`*^9, {
   3.88778931438058*^9, 3.8877893287007446`*^9}, {3.887795529852466*^9, 
   3.8877955710582395`*^9}},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"308214c0-4567-4f12-8e0d-\
3eac8530f2fa"],

Cell[BoxData[
 FormBox["\<\" Lastest Veresion : This Version\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{
  3.8875253388860826`*^9, 3.88753194881915*^9, 3.8875425315013337`*^9, 
   3.887596001145379*^9, 3.887624039301811*^9, 3.8876763438817015`*^9, {
   3.88778931438058*^9, 3.8877893287007446`*^9}, {3.887795529852466*^9, 
   3.887795571065771*^9}},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"df8cfd93-22be-4f56-a3f0-\
7b8e7657ff4c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "classifyAmp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"giveParaProgSets", "[", 
    RowBox[{"FeynAmpD", "[", 
     RowBox[{"lists__", "?", "ListQ"}], "]"}], "]"}], ":=", 
   RowBox[{"{", "lists", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"giveParaProgSets", "[", 
    RowBox[{"a_", " ", "b_"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"giveParaProgSets", "[", "a", "]"}], ",", 
     RowBox[{"giveParaProgSets", "[", "b", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"giveParaProgSets", "[", "a_", "]"}], ":=", 
   RowBox[{"{", "Nothing", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"giveMomentum", "[", 
   RowBox[{
    RowBox[{"slash", "[", "p_", "]"}], ",", "p_"}], "]"}], ":=", 
  "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"giveMomentum", "[", 
   RowBox[{
    RowBox[{"scalarP", "[", 
     RowBox[{"p_", ",", "p_"}], "]"}], ",", "p_"}], "]"}], ":=", 
  "2"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"giveMomentum", "[", 
   RowBox[{
    RowBox[{"scalarP", "[", 
     RowBox[{"p_", ",", "x_"}], "]"}], ",", "p_"}], "]"}], ":=", 
  "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"giveMomentum", "[", 
   RowBox[{
    RowBox[{"fourVector", "[", 
     RowBox[{"p_", ",", "\[Mu]_"}], "]"}], ",", "p_"}], "]"}], ":=", 
  "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"giveMomentum", "[", 
   RowBox[{
    RowBox[{"a_", "  ", "b_"}], ",", "p_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"giveMomentum", "[", 
    RowBox[{"a", ",", "p"}], "]"}], "+", " ", 
   RowBox[{"giveMomentum", "[", 
    RowBox[{"b", ",", "p"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"giveMomentum", "[", 
   RowBox[{
    SuperscriptBox["a_", "n_"], ",", "p_"}], "]"}], ":=", " ", 
  RowBox[{"n", " ", 
   RowBox[{"giveMomentum", "[", 
    RowBox[{"a", ",", "p"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"giveMomentum", "[", "a__", "]"}], ":=", "0"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"classifyAmp", "[", 
   RowBox[{"exp0_", "?", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Level", "[", 
         RowBox[{"#", ",", "Infinity", ",", 
          RowBox[{"Heads", "->", "True"}]}], "]"}], ",", "FeynAmpD"}], "]"}], 
      "&"}], ")"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"exp", " ", "=", "exp0"}], ",", "listk", ",", "listn", ",", 
      "listp", ",", "listreplace", ",", "symbolf"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listk", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"giveParaProgSets", "[", "exp", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"listp", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"giveMomentum", "[", 
         RowBox[{"exp", ",", 
          RowBox[{
           RowBox[{"symbol", "[", "#", "]"}], "#"}]}], "]"}], "&"}], "/@", 
       RowBox[{"listk", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listk", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "listp", "}"}], ",", "listk"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"listk", " ", "=", " ", 
      RowBox[{"SortBy", "[", 
       RowBox[{"listk", ",", 
        RowBox[{"{", 
         RowBox[{"Last", ",", "First"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"listn", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<\[TaurusSign]\>\"", "<>", 
          RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "listk", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"listreplace", "  ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"symbol", "[", 
           RowBox[{
            RowBox[{"listk", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "2"}], "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], 
          RowBox[{
           RowBox[{"listk", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "2"}], "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "->", 
         RowBox[{
          RowBox[{"symbol", "[", 
           RowBox[{
            RowBox[{"listk", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "2"}], "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], 
          RowBox[{"listn", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "listk", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"showYourIndices", "[", 
      RowBox[{
       RowBox[{"exp", "/.", "listreplace"}], ",", "listn"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{"ggg", " ", 
  RowBox[{"scalarP", "[", 
   RowBox[{"k1", ",", "p"}], "]"}], " ", 
  RowBox[{"scalarP", "[", 
   RowBox[{"k1", ",", " ", "k2"}], "]"}], 
  RowBox[{"scalarP", "[", 
   RowBox[{"k2", ",", "k3"}], "]"}], 
  RowBox[{"scalarP", "[", 
   RowBox[{"k3", ",", "k4"}], "]"}], 
  RowBox[{"FeynAmpD", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k1", ",", " ", 
      RowBox[{"mass", "[", "c", "]"}], ",", "4"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "k2"}], ",", " ", 
      RowBox[{"mass", "[", "c", "]"}], ",", " ", "3"}], "}"}], ",", " ", "\n",
     "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "k3"}], ",", " ", 
      RowBox[{"mass", "[", "c", "]"}], ",", "7"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "k4"}], ",", " ", 
      RowBox[{"mass", "[", "c", "]"}], ",", " ", "6"}], "}"}]}], 
   "]"}]}], "\n", 
 RowBox[{"classifyAmp", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.887525345767927*^9, 3.887525629905295*^9}, {
   3.8875264922114906`*^9, 3.8875266525922384`*^9}, {3.887526910987462*^9, 
   3.887526920163685*^9}, {3.8875318188315015`*^9, 3.8875318506794653`*^9}, {
   3.8875319386509457`*^9, 3.8875319714719067`*^9}, {3.8875320097977715`*^9, 
   3.887532155222809*^9}, {3.8875425162599754`*^9, 3.8875425434594383`*^9}, {
   3.8875425818951406`*^9, 3.887542609080151*^9}, {3.8875426639022536`*^9, 
   3.8875428617770944`*^9}, {3.8875429122925024`*^9, 
   3.8875431487598743`*^9}, {3.8875432063442106`*^9, 
   3.8875432173366423`*^9}, {3.8875432719526725`*^9, 3.887543297750251*^9}, {
   3.887543347940384*^9, 3.8875434139204516`*^9}, {3.887596935865258*^9, 
   3.887596967421319*^9}, {3.887597006691224*^9, 3.887597037985202*^9}, {
   3.8875970691927867`*^9, 3.887597082655383*^9}, {3.887597145388341*^9, 
   3.887597150459956*^9}, {3.8876240552323227`*^9, 3.88762405898779*^9}, {
   3.8876240990463305`*^9, 3.887624101046339*^9}, {3.887624183635747*^9, 
   3.887624233218014*^9}, {3.887624268628723*^9, 3.887624497733775*^9}, {
   3.8876245298596325`*^9, 3.887624561434209*^9}, {3.8876245922975435`*^9, 
   3.8876247336066694`*^9}, {3.887624768235485*^9, 3.887624953523981*^9}, {
   3.8876250338557167`*^9, 3.8876252118180513`*^9}, {3.887625248064471*^9, 
   3.887625384126904*^9}, {3.887625719365782*^9, 3.8876257571348248`*^9}, {
   3.8876257986153*^9, 3.887625815353329*^9}, {3.887625854371813*^9, 
   3.887625938484796*^9}, {3.887625973977769*^9, 3.8876259900920825`*^9}, {
   3.8876262085203953`*^9, 3.8876262824671307`*^9}, {3.8876263469231744`*^9, 
   3.8876263895920053`*^9}, {3.887626707855242*^9, 3.8876267088614235`*^9}, {
   3.8876765036330833`*^9, 3.887676520644123*^9}, {3.887676574103886*^9, 
   3.88767662895809*^9}, {3.887676722004214*^9, 3.887676779144247*^9}, {
   3.8876768244546022`*^9, 3.887676933538474*^9}, {3.8876769723743315`*^9, 
   3.887676974349458*^9}, {3.8876770177061863`*^9, 3.8876772056262083`*^9}, {
   3.8876772500680103`*^9, 3.8876772621245375`*^9}, {3.8876772931367807`*^9, 
   3.88767729406426*^9}, {3.88767734252054*^9, 3.8876773864409275`*^9}, {
   3.887677695498598*^9, 3.8876779325176783`*^9}, {3.887678000349802*^9, 
   3.8876780270167656`*^9}, 3.8876780590397186`*^9, {3.8877969774781075`*^9, 
   3.8877969791946697`*^9}, {3.8877988978291755`*^9, 3.8877989927370815`*^9}},
 CellLabel->
  "In[346]:=",ExpressionUUID->"b1b70285-41f7-4446-948a-257e793571a7"],

Cell[BoxData[
 FormBox[
  RowBox[{"ggg", " ", 
   FormBox[
    TagBox[
     RowBox[{"k2", "\[CenterDot]", "k1"}],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     RowBox[{"p", "\[CenterDot]", "k1"}],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     RowBox[{"k3", "\[CenterDot]", "k2"}],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     RowBox[{"k4", "\[CenterDot]", "k3"}],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     FractionBox["1", 
      RowBox[{
       FormBox[
        TagBox[
         TemplateBox[{
           RowBox[{"(", 
             RowBox[{
               SuperscriptBox["k1", "2"], "-", 
               SuperscriptBox[
                FormBox[
                 TagBox[
                  SubscriptBox["m", 
                   RowBox[{"c"}]], DisplayForm], TraditionalForm], "2"]}], 
             ")"}], "4"},
          "Superscript"],
         DisplayForm],
        TraditionalForm], "\[CenterDot]", 
       FormBox[
        TagBox[
         TemplateBox[{
           RowBox[{"(", 
             RowBox[{
               SuperscriptBox["k2", "2"], "-", 
               SuperscriptBox[
                FormBox[
                 TagBox[
                  SubscriptBox["m", 
                   RowBox[{"c"}]], DisplayForm], TraditionalForm], "2"]}], 
             ")"}], "3"},
          "Superscript"],
         DisplayForm],
        TraditionalForm], "\[CenterDot]", 
       FormBox[
        TagBox[
         TemplateBox[{
           RowBox[{"(", 
             RowBox[{
               SuperscriptBox["k3", "2"], "-", 
               SuperscriptBox[
                FormBox[
                 TagBox[
                  SubscriptBox["m", 
                   RowBox[{"c"}]], DisplayForm], TraditionalForm], "2"]}], 
             ")"}], "7"},
          "Superscript"],
         DisplayForm],
        TraditionalForm], "\[CenterDot]", 
       FormBox[
        TagBox[
         TemplateBox[{
           RowBox[{"(", 
             RowBox[{
               SuperscriptBox["k4", "2"], "-", 
               SuperscriptBox[
                FormBox[
                 TagBox[
                  SubscriptBox["m", 
                   RowBox[{"c"}]], DisplayForm], TraditionalForm], "2"]}], 
             ")"}], "6"},
          "Superscript"],
         DisplayForm],
        TraditionalForm]}]],
     DisplayForm],
    TraditionalForm]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.8876257202305512`*^9, 3.887625757685282*^9}, {
   3.8876258023215094`*^9, 3.887625815809662*^9}, {3.887625856799038*^9, 
   3.8876259391112614`*^9}, 3.8876259907522697`*^9, {3.8876262137191505`*^9, 
   3.8876262830798717`*^9}, {3.887626349811366*^9, 3.8876263900782833`*^9}, 
   3.887626709521511*^9, 3.887676366776185*^9, {3.8876768200962715`*^9, 
   3.887676845164651*^9}, {3.887677051950248*^9, 3.8876770708587494`*^9}, {
   3.8876771025403275`*^9, 3.887677168947093*^9}, 3.8876771990443897`*^9, 
   3.887677230296589*^9, 3.887677262586609*^9, 3.8876772945145493`*^9, {
   3.8876773434530754`*^9, 3.887677387060481*^9}, {3.887677697568833*^9, 
   3.8876778747556005`*^9}, {3.8876779064895706`*^9, 
   3.8876779329798512`*^9}, {3.887678004976869*^9, 3.887678027737547*^9}, 
   3.887678059834257*^9, 3.887796979506272*^9, {3.8877989342390347`*^9, 
   3.887798956563387*^9}, 3.887798993365123*^9},
 CellLabel->
  "Out[358]=",ExpressionUUID->"0762ed04-adef-4cc9-b526-41061ae313fc"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", "ggg"}], " ", 
   FormBox[
    TagBox[
     SubscriptBox["p", "\<\"p0\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]1", "\<\"\[TaurusSign]10\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]1", "\<\"\[TaurusSign]11\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]2", "\<\"\[TaurusSign]20\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]2", "\<\"\[TaurusSign]21\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]3", "\<\"\[TaurusSign]30\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]4", "\<\"\[TaurusSign]40\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]4", "\<\"\[TaurusSign]41\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\<\"g\"\>", 
      RowBox[{"p0", "\[TaurusSign]20"}]],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\<\"g\"\>", 
      RowBox[{"\[TaurusSign]10", "\[TaurusSign]21"}]],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\<\"g\"\>", 
      RowBox[{"\[TaurusSign]11", "\[TaurusSign]40"}]],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\<\"g\"\>", 
      RowBox[{"\[TaurusSign]30", "\[TaurusSign]41"}]],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     FractionBox["1", 
      RowBox[{
       FormBox[
        TagBox[
         TemplateBox[{
           RowBox[{"(", 
             RowBox[{
               SuperscriptBox["\[TaurusSign]1", "2"], "-", 
               SuperscriptBox[
                FormBox[
                 TagBox[
                  SubscriptBox["m", 
                   RowBox[{"c"}]], DisplayForm], TraditionalForm], "2"]}], 
             ")"}], "3"},
          "Superscript"],
         DisplayForm],
        TraditionalForm], "\[CenterDot]", 
       FormBox[
        TagBox[
         TemplateBox[{
           RowBox[{"(", 
             RowBox[{
               SuperscriptBox["\[TaurusSign]2", "2"], "-", 
               SuperscriptBox[
                FormBox[
                 TagBox[
                  SubscriptBox["m", 
                   RowBox[{"c"}]], DisplayForm], TraditionalForm], "2"]}], 
             ")"}], "4"},
          "Superscript"],
         DisplayForm],
        TraditionalForm], "\[CenterDot]", 
       FormBox[
        TagBox[
         TemplateBox[{
           RowBox[{"(", 
             RowBox[{
               SuperscriptBox["\[TaurusSign]3", "2"], "-", 
               SuperscriptBox[
                FormBox[
                 TagBox[
                  SubscriptBox["m", 
                   RowBox[{"c"}]], DisplayForm], TraditionalForm], "2"]}], 
             ")"}], "6"},
          "Superscript"],
         DisplayForm],
        TraditionalForm], "\[CenterDot]", 
       FormBox[
        TagBox[
         TemplateBox[{
           RowBox[{"(", 
             RowBox[{
               SuperscriptBox["\[TaurusSign]4", "2"], "-", 
               SuperscriptBox[
                FormBox[
                 TagBox[
                  SubscriptBox["m", 
                   RowBox[{"c"}]], DisplayForm], TraditionalForm], "2"]}], 
             ")"}], "7"},
          "Superscript"],
         DisplayForm],
        TraditionalForm]}]],
     DisplayForm],
    TraditionalForm]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.8876257202305512`*^9, 3.887625757685282*^9}, {
   3.8876258023215094`*^9, 3.887625815809662*^9}, {3.887625856799038*^9, 
   3.8876259391112614`*^9}, 3.8876259907522697`*^9, {3.8876262137191505`*^9, 
   3.8876262830798717`*^9}, {3.887626349811366*^9, 3.8876263900782833`*^9}, 
   3.887626709521511*^9, 3.887676366776185*^9, {3.8876768200962715`*^9, 
   3.887676845164651*^9}, {3.887677051950248*^9, 3.8876770708587494`*^9}, {
   3.8876771025403275`*^9, 3.887677168947093*^9}, 3.8876771990443897`*^9, 
   3.887677230296589*^9, 3.887677262586609*^9, 3.8876772945145493`*^9, {
   3.8876773434530754`*^9, 3.887677387060481*^9}, {3.887677697568833*^9, 
   3.8876778747556005`*^9}, {3.8876779064895706`*^9, 
   3.8876779329798512`*^9}, {3.887678004976869*^9, 3.887678027737547*^9}, 
   3.887678059834257*^9, 3.887796979506272*^9, {3.8877989342390347`*^9, 
   3.887798956563387*^9}, 3.8877989933812227`*^9},
 CellLabel->
  "Out[359]=",ExpressionUUID->"80668b8b-a9ec-4f4d-a992-a78cce741037"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"scalarP", "[", 
  RowBox[{
   RowBox[{"-", "p"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.887677318692568*^9, 3.8876773226688237`*^9}},
 CellLabel->
  "In[366]:=",ExpressionUUID->"b9debb22-f9e8-485b-89d9-3e3f4c08d143"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   RowBox[{"(", 
    FormBox[
     TagBox[
      RowBox[{"x", "\[CenterDot]", "p"}],
      DisplayForm],
     TraditionalForm], ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.8876773230528784`*^9},
 CellLabel->
  "Out[366]=",ExpressionUUID->"15cbed5a-e052-4ff5-af62-27f488dd3039"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ls", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fold", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"#1", "+", "#2"}], ",", "0", ",", 
       RowBox[{"-", "2"}]}], "]"}], "&"}], ",", "0", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "5", ",", "6"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Flatten", "[", "%", "]"}], "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.8877866401159997`*^9, 3.887786733541539*^9}, {
  3.8877868541649256`*^9, 3.887786889974065*^9}, {3.8877870070812764`*^9, 
  3.8877870188827815`*^9}, {3.88778712604618*^9, 3.887787133956232*^9}, {
  3.887796176325724*^9, 3.8877961818512316`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"4e431bc4-e240-4080-b3dc-1bf77c54ce3d"],

Cell[BoxData[
 FormBox["143", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.887787019649397*^9, 3.8877871343625407`*^9, {3.8877961646070576`*^9, 
   3.887796183382455*^9}},
 CellLabel->
  "Out[159]=",ExpressionUUID->"31ced165-b96f-431b-9f83-0999be58dbeb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["ls"], "Input",
 CellChangeTimes->{{3.887786894304165*^9, 3.8877869198991528`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"0b7c1f17-568e-4376-8e32-7675e3c9bbc8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10", ",", "8", ",", "6", ",", "4", ",", "2", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "6", ",", "4", ",", "2", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "4", ",", "2", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"8", ",", "6", ",", "4", ",", "2", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "4", ",", "2", ",", "0"}], "}"}]}], "}"}]}], "}"}], 
   ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{{3.887786894922185*^9, 3.8877869204364853`*^9}, 
   3.8877870215414114`*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"94a22fa2-823a-4da4-ad05-4615aebd1919"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"16", "*", "9"}]], "Input",
 CellChangeTimes->{{3.8877871623114753`*^9, 3.887787217624516*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"3482d9f3-b160-4cf0-ac0f-6b639bd8953e"],

Cell[BoxData["144"], "Output",
 CellChangeTimes->{{3.8877871729426165`*^9, 3.887787218124609*^9}},
 CellLabel->"Out[57]=",ExpressionUUID->"d6ddadc9-14eb-418b-a524-c7f8a5fd2860"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"genVector", "[", 
   RowBox[{"q_", ",", 
    RowBox[{"lists_", "?", "ListQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Times", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"fourVector", "[", 
       RowBox[{"q", ",", "#"}], "]"}], "&"}], "/@", "lists"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subPartition", "[", 
   RowBox[{
    RowBox[{"lists_", "?", "ListQ"}], ",", 
    RowBox[{"n_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"#", ",", 
      RowBox[{"Complement", "[", 
       RowBox[{"lists", ",", "#"}], "]"}]}], "}"}], "&"}], "/@", 
   RowBox[{"Subsets", "[", 
    RowBox[{"lists", ",", 
     RowBox[{"{", "n", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genMetric", "[", 
   RowBox[{"lists_", "?", "ListQ"}], "]"}], ":=", 
  RowBox[{"Times", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"metric", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Partition", "[", 
      RowBox[{"lists", ",", "2"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genMetrick", "[", 
   RowBox[{
    RowBox[{"lists_", "?", "ListQ"}], ",", 
    RowBox[{"n_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"genVector", "[", 
          RowBox[{
           RowBox[{"ToExpression", "[", "\"\<q\>\"", "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
         RowBox[{"genMetric", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], "/@", 
       RowBox[{"subPartition", "[", 
        RowBox[{"lists", ",", "n"}], "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genStruct", "[", 
   RowBox[{"lists_", "?", "ListQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "lists", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"genMetrick", "[", 
         RowBox[{"lists", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"n", ",", "0", ",", 
         RowBox[{"-", "2"}]}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"genStruct", "[", 
     RowBox[{"Range", "[", "i", "]"}], "]"}], "//", "Length"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "16"}], "}"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8877878073480444`*^9, 3.887787907096038*^9}, {
   3.8877879401339664`*^9, 3.8877880465201406`*^9}, {3.8877880959212832`*^9, 
   3.8877881595654874`*^9}, {3.8877883014852*^9, 3.8877883924622383`*^9}, {
   3.88778848718573*^9, 3.887788662077935*^9}, {3.8877886990109377`*^9, 
   3.8877888691243067`*^9}, {3.8877889452670937`*^9, 
   3.8877889814338884`*^9}, {3.887789035591952*^9, 3.887789205856073*^9}, {
   3.887789240202792*^9, 3.8877892512523737`*^9}, {3.887789370768198*^9, 
   3.887789431690587*^9}, {3.887789470846998*^9, 3.887789495746443*^9}, {
   3.887789528309084*^9, 3.8877897508505535`*^9}, {3.887790546124893*^9, 
   3.887790594043441*^9}, {3.8877906261367874`*^9, 3.8877906304376907`*^9}, {
   3.8877908976067595`*^9, 3.887790951446165*^9}, {3.8877909843805914`*^9, 
   3.8877910269803963`*^9}, {3.88779111392362*^9, 3.8877912344472747`*^9}, {
   3.887791301483711*^9, 3.887791343857572*^9}, {3.887791393579791*^9, 
   3.887791418677951*^9}, {3.887791498473626*^9, 3.887791499631058*^9}, {
   3.8877915497064247`*^9, 3.8877915511453934`*^9}, 3.8877917387583685`*^9, {
   3.8877955884948883`*^9, 3.887795882224083*^9}, {3.8877959368212385`*^9, 
   3.887796008441332*^9}, {3.887796046992755*^9, 3.8877960904795074`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"162c6e5b-0fc8-47b5-a068-20ae69b2ddb1"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
   "2", ",", "2", ",", "4", ",", "8", ",", "16", ",", "32", ",", "64", ",", 
    "128", ",", "256", ",", "512", ",", "1024", ",", "2048", ",", "4096", ",",
     "8192", ",", "16384", ",", "32768"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.8877891109608574`*^9, 3.887789136676843*^9}, {
   3.8877891816370597`*^9, 3.88778920654383*^9}, 3.8877892522064323`*^9, {
   3.887789381617606*^9, 3.8877893934246445`*^9}, 3.8877894322538333`*^9, {
   3.8877894796468506`*^9, 3.8877894964968834`*^9}, {3.887789554527255*^9, 
   3.8877895584221597`*^9}, {3.8877896038152933`*^9, 3.887789631994316*^9}, {
   3.8877897275489407`*^9, 3.887789751459486*^9}, 3.8877907310263834`*^9, 
   3.887790919215796*^9, 3.8877909529154005`*^9, 3.887790993652896*^9, {
   3.887791170116062*^9, 3.887791234978816*^9}, 3.8877913020310884`*^9, {
   3.8877913983949776`*^9, 3.887791419616643*^9}, 3.887791500600691*^9, 
   3.887791551537196*^9, {3.887791726324675*^9, 3.8877917405878763`*^9}, {
   3.88779563075178*^9, 3.8877957134748964`*^9}, {3.8877958198256955`*^9, 
   3.8877958827259393`*^9}, {3.8877959537379274`*^9, 
   3.8877960091791334`*^9}, {3.8877960771534386`*^9, 3.8877960930383754`*^9}},
 CellLabel->
  "Out[145]=",ExpressionUUID->"22529458-43ea-41b7-8e59-d8f4b0528eec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"genStruct", "[", 
  RowBox[{"Range", "[", "12", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8877961037370453`*^9, 3.887796137469344*^9}, {
  3.887796275934424*^9, 3.887796321498698*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"e4236704-5e23-4f1c-a87b-3141c1d3a715"],

Cell[BoxData[
 FormBox[
  TemplateBox[<|"shortenedBoxes" -> TagBox[
      RowBox[{
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["q", "1"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "2"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "3"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "4"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "5"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "6"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "7"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "8"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "9"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "10"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "11"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "12"], DisplayForm], TraditionalForm]}], "+", 
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["q", "3"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "4"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "5"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "6"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "7"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "8"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "9"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "10"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "11"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"1", "2"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "12"], DisplayForm], TraditionalForm]}], "+", 
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["q", "2"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "4"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "5"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "6"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "7"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "8"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "9"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "10"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "11"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"1", "3"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "12"], DisplayForm], TraditionalForm]}], "+", 
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["q", "2"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "3"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "5"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "6"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "7"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "8"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "9"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "10"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "11"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"1", "4"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "12"], DisplayForm], TraditionalForm]}], "+", 
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["q", "2"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "3"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "4"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "6"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "7"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "8"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "9"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "10"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "11"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"1", "5"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "12"], DisplayForm], TraditionalForm]}], "+", 
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["q", "2"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "3"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "4"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "5"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "7"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "8"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "9"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "10"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "11"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"1", "6"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "12"], DisplayForm], TraditionalForm]}], "+", 
        TemplateBox[{"2037"}, "OutputSizeLimit`Skeleton"], "+", 
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["q", "2"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "3"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"1", "4"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"5", "6"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"7", "8"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"9", "10"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"11", "12"}]], DisplayForm], TraditionalForm]}], "+", 
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["q", "1"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "4"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"2", "3"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"5", "6"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"7", "8"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"9", "10"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"11", "12"}]], DisplayForm], TraditionalForm]}], "+", 
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["q", "1"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "3"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"2", "4"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"5", "6"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"7", "8"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"9", "10"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"11", "12"}]], DisplayForm], TraditionalForm]}], "+", 
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["q", "1"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["q", "2"], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"3", "4"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"5", "6"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"7", "8"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"9", "10"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"11", "12"}]], DisplayForm], TraditionalForm]}], "+", 
        RowBox[{
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"1", "2"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"3", "4"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"5", "6"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"7", "8"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"9", "10"}]], DisplayForm], TraditionalForm], " ", 
          FormBox[
           TagBox[
            SubscriptBox["\"g\"", 
             RowBox[{"11", "12"}]], DisplayForm], TraditionalForm]}]}], 
      Short[#, 8]& ], "line" -> 162, "sessionID" -> 31505613242903903041, 
    "byteCount" -> 1672192, "size" -> 8, "stored" -> False, "expr" -> 
    Missing["NotAvailable", "NewSessionID"], "wrap" -> OutputSizeLimit`Defer, 
    "version" -> 1|>,
   "OutputSizeLimitTemplate"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.8877961126460376`*^9, 3.8877961377205167`*^9}, {
   3.887796279335996*^9, 3.887796290366393*^9}, 3.887796322487065*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"6e99d50c-22f0-4083-b03e-61f593dd3748"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"indexNew", "[", 
  RowBox[{"\"\<\[Mu]\>\"", ",", 
   RowBox[{"\"\<EndQ\>\"", "->", " ", "True"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"indexNew", "[", 
  RowBox[{"\"\<\[Mu]\>\"", ",", 
   RowBox[{"\"\<EndQ\>\"", "->", " ", "True"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"indexNew", "[", 
  RowBox[{"\"\<\[Mu]\>\"", ",", 
   RowBox[{"\"\<EndQ\>\"", "->", " ", "True"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"indexNew", "[", 
  RowBox[{"\"\<\[Nu]\>\"", ",", 
   RowBox[{"\"\<EndQ\>\"", "->", " ", "True"}]}], "]"}]}], "Input",
 CellLabel->
  "In[171]:=",ExpressionUUID->"82ab49bd-b7ca-4b5d-9e4f-2c973d83b49a"],

Cell[BoxData[
 FormBox["\[Mu]6", TraditionalForm]], "Output",
 CellChangeTimes->{{3.8877963606945972`*^9, 3.8877963649758067`*^9}},
 CellLabel->
  "Out[171]=",ExpressionUUID->"7b208d75-e116-4445-9d92-6873246d6514"],

Cell[BoxData[
 FormBox["\[Mu]7", TraditionalForm]], "Output",
 CellChangeTimes->{{3.8877963606945972`*^9, 3.887796364991434*^9}},
 CellLabel->
  "Out[172]=",ExpressionUUID->"9ea36a70-882e-481a-9671-fa783f227a25"],

Cell[BoxData[
 FormBox["\[Mu]8", TraditionalForm]], "Output",
 CellChangeTimes->{{3.8877963606945972`*^9, 3.887796364991434*^9}},
 CellLabel->
  "Out[173]=",ExpressionUUID->"c0af186e-e137-43dd-9701-c31189d33ed2"],

Cell[BoxData[
 FormBox["\[Nu]2", TraditionalForm]], "Output",
 CellChangeTimes->{{3.8877963606945972`*^9, 3.887796364991434*^9}},
 CellLabel->
  "Out[174]=",ExpressionUUID->"e9bf89ec-0d8a-4032-9bb7-6b74f317c6fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"indexNew", "[", "\"\<\[TaurusSign]\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8877963677158313`*^9, 3.8877963786864977`*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"e792a237-2b5b-4a72-95a9-81b9c9fc45ca"],

Cell[BoxData[
 FormBox["\[TaurusSign]0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.8877963744141397`*^9, 3.887796382629909*^9}},
 CellLabel->
  "Out[178]=",ExpressionUUID->"474a3b8a-68ba-48fc-b829-a42bf3c51510"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"showYourIndices", "[", 
   RowBox[{"exp_", ",", 
    RowBox[{"lists_", "?", "ListQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"explists", " ", "=", " ", 
       RowBox[{"FactorList", "[", "exp", "]"}]}], ",", 
      RowBox[{"countnum", " ", "=", " ", 
       RowBox[{"Association", "[", "]"}]}], ",", "ids", ",", "result"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", " ", "=", " ", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
         "explists"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"scalarP", "[", 
           RowBox[{
            RowBox[{"x_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"lists", ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
            "p_"}], "]"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ids", "=", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MissingQ", "[", 
                    RowBox[{"countnum", "[", "#", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"countnum", ",", 
                    RowBox[{"#", "->", "0"}]}], "]"}], ";", "0"}], ",", 
                    RowBox[{"countnum", "[", "#", "]"}]}], "]"}], ";", 
                    RowBox[{
                    RowBox[{"countnum", "[", "#", "]"}], "++"}]}], ")"}], 
                  "]"}]}], "&"}], "/@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ToString", "[", "x", "]"}], ",", 
                 RowBox[{"ToString", "[", "p", "]"}]}], "}"}]}], ")"}]}], ";", 
            RowBox[{
             RowBox[{"fourVector", "[", 
              RowBox[{"x", ",", 
               RowBox[{"ids", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
             RowBox[{"fourVector", "[", 
              RowBox[{"p", ",", 
               RowBox[{"ids", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
             RowBox[{"metric", "[", 
              RowBox[{
               RowBox[{"ids", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"ids", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"slash", "[", 
           RowBox[{"x_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"lists", ",", "#"}], "]"}], "&"}], ")"}]}], "]"}], ":>",
           " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ids", "=", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MissingQ", "[", 
                    RowBox[{"countnum", "[", "#", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"countnum", ",", 
                    RowBox[{"#", "->", "0"}]}], "]"}], ";", "0"}], ",", 
                    RowBox[{"countnum", "[", "#", "]"}]}], "]"}], ";", 
                    RowBox[{
                    RowBox[{"countnum", "[", "#", "]"}], "++"}]}], ")"}], 
                  "]"}]}], "&"}], "[", 
               RowBox[{"ToString", "[", "x", "]"}], "]"}], ")"}]}], ";", 
            RowBox[{
             RowBox[{"gamma", "[", "ids", "]"}], 
             RowBox[{"fourVector", "[", 
              RowBox[{"x", ",", "ids"}], "]"}]}]}], ")"}]}]}], "}"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Times", "@@", "result"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"gg", " ", 
  RowBox[{"scalarP", "[", 
   RowBox[{"\[TaurusSign]1", ",", "\[TaurusSign]2"}], "]"}], " ", 
  RowBox[{"scalarP", "[", 
   RowBox[{"\[TaurusSign]1", ",", "\[TaurusSign]4"}], "]"}], " ", 
  RowBox[{"scalarP", "[", 
   RowBox[{"\[TaurusSign]3", ",", "\[TaurusSign]4"}], "]"}], 
  RowBox[{"scalarP", "[", 
   RowBox[{"\[TaurusSign]2", ",", "\[TaurusSign]1"}], "]"}], 
  RowBox[{"slash", "[", "\[TaurusSign]3", "]"}], 
  RowBox[{"scalarP", "[", 
   RowBox[{"\[TaurusSign]4", ",", "\[TaurusSign]4"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"showYourIndices", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"\[TaurusSign]1", ",", "\[TaurusSign]2", ",", "\[TaurusSign]3"}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8877969903523984`*^9, 3.887797202103566*^9}, {
   3.887797235762761*^9, 3.887797273135233*^9}, 3.8877973224354362`*^9, {
   3.8877973587887535`*^9, 3.887797369646901*^9}, {3.8877974158504453`*^9, 
   3.887797568228915*^9}, {3.887797620981269*^9, 3.8877976228777447`*^9}, {
   3.8877976652862344`*^9, 3.887797842484547*^9}, {3.8877978961071377`*^9, 
   3.887797997834999*^9}, 3.887798052535454*^9, {3.887798094934868*^9, 
   3.8877981074646697`*^9}, {3.8877981392076235`*^9, 
   3.8877981564907904`*^9}, {3.8877982601197824`*^9, 3.887798287217482*^9}, {
   3.8877983285018167`*^9, 3.887798365472517*^9}, {3.8877984032193737`*^9, 
   3.887798470629737*^9}, {3.887798515786008*^9, 3.8877986278119955`*^9}, {
   3.8877986723121195`*^9, 3.88779868651285*^9}, {3.887798718770052*^9, 
   3.8877987215858116`*^9}, {3.887798758798353*^9, 3.887798788948351*^9}, {
   3.887798821022357*^9, 3.8877988505074363`*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"00161202-251b-4f8b-b674-d4f3e83e8b0d"],

Cell[BoxData[
 FormBox[
  RowBox[{"gg", " ", 
   FormBox[
    TagBox[
     OverscriptBox["\[TaurusSign]3", "^"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SuperscriptBox["\[TaurusSign]4", "2"],
     DisplayForm],
    TraditionalForm], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FormBox[
      TagBox[
       RowBox[{"\[TaurusSign]2", "\[CenterDot]", "\[TaurusSign]1"}],
       DisplayForm],
      TraditionalForm], ")"}], "2"], " ", 
   FormBox[
    TagBox[
     RowBox[{"\[TaurusSign]4", "\[CenterDot]", "\[TaurusSign]1"}],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     RowBox[{"\[TaurusSign]4", "\[CenterDot]", "\[TaurusSign]3"}],
     DisplayForm],
    TraditionalForm]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.8877971095196233`*^9, 3.8877971240198145`*^9}, {
   3.8877971590917044`*^9, 3.887797203045365*^9}, 3.887797273386299*^9, 
   3.8877973237553806`*^9, {3.8877973620070243`*^9, 3.8877973701956034`*^9}, {
   3.8877975508498588`*^9, 3.887797571573045*^9}, 3.88779762342826*^9, 
   3.8877976708322053`*^9, {3.8877977745555234`*^9, 3.887797788501594*^9}, 
   3.8877978431759653`*^9, {3.8877979195669823`*^9, 3.8877979448606024`*^9}, {
   3.8877979749320345`*^9, 3.8877979988251343`*^9}, 3.887798053007308*^9, 
   3.887798096997506*^9, {3.887798153483344*^9, 3.887798156930461*^9}, {
   3.8877982831535397`*^9, 3.887798287753189*^9}, 3.8877983662880507`*^9, 
   3.88779847114804*^9, 3.8877986324767284`*^9, 3.887798687374609*^9, 
   3.8877987223867903`*^9, {3.8877987821410117`*^9, 3.8877987897041197`*^9}, {
   3.887798844436392*^9, 3.887798857271098*^9}},
 CellLabel->
  "Out[302]=",ExpressionUUID->"450cc079-11e4-4f5a-9b85-c8b39485e3ed"],

Cell[BoxData[
 FormBox[
  RowBox[{"gg", " ", 
   FormBox[
    TagBox[
     SuperscriptBox["\[TaurusSign]4", "2"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]1", "\<\"\[TaurusSign]10\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]1", "\<\"\[TaurusSign]11\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]1", "\<\"\[TaurusSign]12\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]2", "\<\"\[TaurusSign]20\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]2", "\<\"\[TaurusSign]21\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]3", "\<\"\[TaurusSign]30\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]3", "\<\"\[TaurusSign]31\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]4", "\<\"\[TaurusSign]40\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\[TaurusSign]4", "\<\"\[TaurusSign]41\"\>"],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\<\"g\"\>", 
      RowBox[{"\[TaurusSign]10", "\[TaurusSign]20"}]],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\<\"g\"\>", 
      RowBox[{"\[TaurusSign]11", "\[TaurusSign]21"}]],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\<\"g\"\>", 
      RowBox[{"\[TaurusSign]12", "\[TaurusSign]40"}]],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     SubscriptBox["\<\"g\"\>", 
      RowBox[{"\[TaurusSign]30", "\[TaurusSign]41"}]],
     DisplayForm],
    TraditionalForm], " ", 
   FormBox[
    TagBox[
     TemplateBox[{"\"\[Gamma]\"", "\"\[TaurusSign]31\""},
      "Superscript"],
     DisplayForm],
    TraditionalForm]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.8877971095196233`*^9, 3.8877971240198145`*^9}, {
   3.8877971590917044`*^9, 3.887797203045365*^9}, 3.887797273386299*^9, 
   3.8877973237553806`*^9, {3.8877973620070243`*^9, 3.8877973701956034`*^9}, {
   3.8877975508498588`*^9, 3.887797571573045*^9}, 3.88779762342826*^9, 
   3.8877976708322053`*^9, {3.8877977745555234`*^9, 3.887797788501594*^9}, 
   3.8877978431759653`*^9, {3.8877979195669823`*^9, 3.8877979448606024`*^9}, {
   3.8877979749320345`*^9, 3.8877979988251343`*^9}, 3.887798053007308*^9, 
   3.887798096997506*^9, {3.887798153483344*^9, 3.887798156930461*^9}, {
   3.8877982831535397`*^9, 3.887798287753189*^9}, 3.8877983662880507`*^9, 
   3.88779847114804*^9, 3.8877986324767284`*^9, 3.887798687374609*^9, 
   3.8877987223867903`*^9, {3.8877987821410117`*^9, 3.8877987897041197`*^9}, {
   3.887798844436392*^9, 3.887798857286771*^9}},
 CellLabel->
  "Out[303]=",ExpressionUUID->"f53f7947-8fdd-440a-ac15-b55087c3cc61"]
}, Open  ]],

Cell[BoxData["ConstantArray"], "Input",
 CellChangeTimes->{{3.8877973080797405`*^9, 
  3.887797310136441*^9}},ExpressionUUID->"d3e91416-647e-4957-8419-\
a28e8a68483f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MissingQ", "[", "#", "]"}], ",", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"countnum", ",", 
        RowBox[{"#", "->", "0"}]}], "]"}], ";", "0"}], ",", 
     RowBox[{"countnum", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ToString", "[", "x", "]"}], ",", 
    RowBox[{"ToString", "[", "p", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8877980331734095`*^9, 3.887798043985968*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"8509571e-eb90-4b1f-9138-f0617be64edd"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"countnum", "(", "\<\"x\"\>", ")"}], ",", 
    RowBox[{"countnum", "(", "\<\"p\"\>", ")"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.887798033676305*^9, 3.8877980444410334`*^9}},
 CellLabel->
  "Out[258]=",ExpressionUUID->"a3c4bfe0-4716-4c50-95e0-3c4a28db8ee4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "6", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "}"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.887969035309825*^9, 3.8879690671091814`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"88bd21d2-1968-4a64-8f0f-8ae09a5e2cb4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "6", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.88796906793797*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"75303768-e878-4a50-a5a9-2efcb2c53fd7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"addSubTree", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n1_", ",", "l1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2_", ",", "l2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Tree", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n1", ",", "l1"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n2", ",", "#"}], "}"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"l1", "+", "l2"}], ",", "0", ",", 
       RowBox[{"-", "2"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constructTree", "[", 
   RowBox[{
    RowBox[{"listn_", "?", "ListQ"}], ",", 
    RowBox[{"listl_", "?", "ListQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"list", " ", "=", " ", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"listn", ",", "listl"}], "}"}], "]"}]}], ",", 
      RowBox[{"edges", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", "root", ",", "out"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"root", " ", "=", " ", 
      RowBox[{"First", "[", "list", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", " ", "=", " ", "root"}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", " ", "=", " ", 
      RowBox[{"list", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"constructTree", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "6", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8879690918687596`*^9, 3.887969317943562*^9}, {
   3.8879693517790947`*^9, 3.887969460423125*^9}, {3.887969506893223*^9, 
   3.887969579846682*^9}, {3.887969722457285*^9, 3.8879697370088654`*^9}, {
   3.8879698947757034`*^9, 3.887970110555315*^9}, {3.887970198147108*^9, 
   3.8879702231850653`*^9}, {3.8879705230330434`*^9, 3.8879706320052*^9}, {
   3.887970692730035*^9, 3.887970702075822*^9}, {3.8879707475460906`*^9, 
   3.887970770688244*^9}, {3.887970865773017*^9, 3.887970936250905*^9}, {
   3.8879709881966057`*^9, 3.887971013379381*^9}, {3.887971046627948*^9, 
   3.8879710506797085`*^9}, {3.8879711696056075`*^9, 3.887971493063739*^9}, {
   3.887971540368661*^9, 3.887971575579791*^9}, {3.8879716291200995`*^9, 
   3.887971693556055*^9}, {3.887971744240179*^9, 3.8879719462997856`*^9}, 
   3.887972012325043*^9, {3.8879720608827333`*^9, 3.8879721376835413`*^9}, {
   3.887972372042301*^9, 3.8879724668471704`*^9}, {3.88797250103869*^9, 
   3.887972512644356*^9}, {3.8879725515459275`*^9, 3.8879726181410336`*^9}, {
   3.887972672591888*^9, 3.887972720066668*^9}, {3.8879729896683235`*^9, 
   3.887973032495858*^9}, {3.8879732857300296`*^9, 3.887973443544615*^9}, {
   3.887973515585936*^9, 3.8879735438284206`*^9}, {3.887973583301115*^9, 
   3.8879739886895866`*^9}},ExpressionUUID->"3057f7bf-7e24-40ed-89d0-\
7df9740770ea"],

Cell[BoxData[
 TemplateBox[{
  "Function", "slotn", 
   "\"\\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"#2\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\
\", \\\"#1\\\"}], \\\"}\\\"}], \\\"&\\\"}]\\) \:4e2d\:7684\:53c2\:6570\:6570\
\:76ee \\!\\(\\*RowBox[{\\\"2\\\"}]\\) \:4e0d\:80fd\:4ece \
\\!\\(\\*RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"#2\\\", \\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\
\[RightDoubleBracket]\\\"}], \\\",\\\", \\\"#1\\\"}], \\\"}\\\"}], \
\\\"&\\\"}], \\\")\\\"}], \\\"[\\\", \\\"2\\\", \\\"]\\\"}]\\) \:4e2d\:586b\
\:5145.\"", 2, 46, 7, 31506772496835952914, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887973931939149*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[44]:=",ExpressionUUID->"fafac213-35ad-49f9-8b1d-\
7d96fd3ab8cd"],

Cell[BoxData[
 TemplateBox[{
  "Function", "slotn", 
   "\"\\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"#2\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\
\", \\\"#1\\\"}], \\\"}\\\"}], \\\"&\\\"}]\\) \:4e2d\:7684\:53c2\:6570\:6570\
\:76ee \\!\\(\\*RowBox[{\\\"2\\\"}]\\) \:4e0d\:80fd\:4ece \
\\!\\(\\*RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"#2\\\", \\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\
\[RightDoubleBracket]\\\"}], \\\",\\\", \\\"#1\\\"}], \\\"}\\\"}], \
\\\"&\\\"}], \\\")\\\"}], \\\"[\\\", \\\"0\\\", \\\"]\\\"}]\\) \:4e2d\:586b\
\:5145.\"", 2, 46, 8, 31506772496835952914, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8879739319547687`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[44]:=",ExpressionUUID->"eb66d202-e626-415a-a185-\
91ee47a4129e"],

Cell[BoxData[
 TemplateBox[{
  "Function", "slotn", 
   "\"\\!\\(\\*RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"#2\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \\\",\\\
\", \\\"#1\\\"}], \\\"}\\\"}], \\\"&\\\"}]\\) \:4e2d\:7684\:53c2\:6570\:6570\
\:76ee \\!\\(\\*RowBox[{\\\"2\\\"}]\\) \:4e0d\:80fd\:4ece \
\\!\\(\\*RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"#2\\\", \\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\
\[RightDoubleBracket]\\\"}], \\\",\\\", \\\"#1\\\"}], \\\"}\\\"}], \
\\\"&\\\"}], \\\")\\\"}], \\\"[\\\", RowBox[{\\\"{\\\", RowBox[{\\\"4\\\", \\\
\",\\\", \\\"2\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\"]\\\"}]\\) \
\:4e2d\:586b\:5145.\"", 2, 46, 9, 31506772496835952914, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887973931970353*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[44]:=",ExpressionUUID->"4aa77db2-5c24-430d-8845-\
8bcbcde50405"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"\:5728\:672c\:6b21\:8ba1\:7b97\:4e2d\:ff0c\\!\\(\\*StyleBox[RowBox[{\\\"\
Function\\\", \\\"::\\\", \\\"slotn\\\"}], \\\"MessageName\\\"]\\) \:7684\
\:8fdb\:4e00\:6b65\:8f93\:51fa\:5c06\:88ab\:6291\:5236.\"", 2, 46, 10, 
   31506772496835952914, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887973931986019*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[44]:=",ExpressionUUID->"b1eff16c-6167-4a85-90ff-\
524170e65ca9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"{", "0", "}"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.887973932001604*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"bbb833ab-6546-4b2e-9d36-674a6d2e48a4"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8879733220132375`*^9, 
  3.887973327920763*^9}},ExpressionUUID->"fd99ddcd-d875-42e5-ac2c-\
812765a39f85"]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.3 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (2022\:5e7411\:670818\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"be7167d2-3bec-4087-b684-b9c4acccdedc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 131, 3, 36, "Input",ExpressionUUID->"348dcfdd-f9aa-4a50-ab46-7eefe36073fa"],
Cell[CellGroupData[{
Cell[714, 27, 220, 5, 56, "Input",ExpressionUUID->"4ca7e658-21bf-477b-bd8c-699d87299747"],
Cell[CellGroupData[{
Cell[959, 36, 1986, 52, 29, "Print",ExpressionUUID->"cfe176cc-ce5d-4d21-938f-1e596bcfa468"],
Cell[2948, 90, 743, 16, 30, "Print",ExpressionUUID->"366a2de7-0ac3-4c16-bc2c-151fbe956a5e"],
Cell[3694, 108, 477, 10, 29, "Print",ExpressionUUID->"00d67eff-09e4-48ea-bc97-ce8bd1e5dd92"],
Cell[4174, 120, 453, 9, 29, "Print",ExpressionUUID->"308214c0-4567-4f12-8e0d-3eac8530f2fa"],
Cell[4630, 131, 469, 10, 27, "Print",ExpressionUUID->"df8cfd93-22be-4f56-a3f0-7b8e7657ff4c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5148, 147, 8574, 211, 938, "Input",ExpressionUUID->"b1b70285-41f7-4446-948a-257e793571a7"],
Cell[13725, 360, 3472, 103, 67, "Output",ExpressionUUID->"0762ed04-adef-4cc9-b526-41061ae313fc"],
Cell[17200, 465, 4759, 148, 67, "Output",ExpressionUUID->"80668b8b-a9ec-4f4d-a992-a78cce741037"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21996, 618, 253, 6, 36, "Input",ExpressionUUID->"b9debb22-f9e8-485b-89d9-3e3f4c08d143"],
Cell[22252, 626, 332, 11, 42, "Output",ExpressionUUID->"15cbed5a-e052-4ff5-af62-27f488dd3039"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22621, 642, 869, 22, 126, "Input",ExpressionUUID->"4e431bc4-e240-4080-b3dc-1bf77c54ce3d"],
Cell[23493, 666, 262, 6, 40, "Output",ExpressionUUID->"31ced165-b96f-431b-9f83-0999be58dbeb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23792, 677, 175, 2, 36, "Input",ExpressionUUID->"0b7c1f17-568e-4376-8e32-7675e3c9bbc8"],
Cell[23970, 681, 852, 23, 41, "Output",ExpressionUUID->"94a22fa2-823a-4da4-ad05-4615aebd1919"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24859, 709, 197, 3, 36, "Input",ExpressionUUID->"3482d9f3-b160-4cf0-ac0f-6b639bd8953e"],
Cell[25059, 714, 177, 2, 41, "Output",ExpressionUUID->"d6ddadc9-14eb-418b-a524-c7f8a5fd2860"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25273, 721, 4289, 109, 454, "Input",ExpressionUUID->"162c6e5b-0fc8-47b5-a068-20ae69b2ddb1"],
Cell[29565, 832, 1321, 21, 40, "Output",ExpressionUUID->"22529458-43ea-41b7-8e59-d8f4b0528eec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30923, 858, 295, 6, 56, "Input",ExpressionUUID->"e4236704-5e23-4f1c-a87b-3141c1d3a715"],
Cell[31221, 866, 13253, 358, 141, "Output",ExpressionUUID->"6e99d50c-22f0-4083-b03e-61f593dd3748"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44511, 1229, 657, 17, 193, "Input",ExpressionUUID->"82ab49bd-b7ca-4b5d-9e4f-2c973d83b49a"],
Cell[45171, 1248, 214, 4, 42, "Output",ExpressionUUID->"7b208d75-e116-4445-9d92-6873246d6514"],
Cell[45388, 1254, 212, 4, 42, "Output",ExpressionUUID->"9ea36a70-882e-481a-9671-fa783f227a25"],
Cell[45603, 1260, 212, 4, 42, "Output",ExpressionUUID->"c0af186e-e137-43dd-9701-c31189d33ed2"],
Cell[45818, 1266, 212, 4, 40, "Output",ExpressionUUID->"e9bf89ec-0d8a-4032-9bb7-6b74f317c6fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46067, 1275, 234, 4, 36, "Input",ExpressionUUID->"e792a237-2b5b-4a72-95a9-81b9c9fc45ca"],
Cell[46304, 1281, 220, 4, 40, "Output",ExpressionUUID->"474a3b8a-68ba-48fc-b829-a42bf3c51510"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46561, 1290, 6223, 149, 645, "Input",ExpressionUUID->"00161202-251b-4f8b-b674-d4f3e83e8b0d"],
Cell[52787, 1441, 1728, 43, 45, "Output",ExpressionUUID->"450cc079-11e4-4f5a-9b85-c8b39485e3ed"],
Cell[54518, 1486, 3138, 96, 42, "Output",ExpressionUUID->"f53f7947-8fdd-440a-ac15-b55087c3cc61"]
}, Open  ]],
Cell[57671, 1585, 167, 3, 56, "Input",ExpressionUUID->"d3e91416-647e-4957-8419-a28e8a68483f"],
Cell[CellGroupData[{
Cell[57863, 1592, 611, 17, 56, "Input",ExpressionUUID->"8509571e-eb90-4b1f-9138-f0617be64edd"],
Cell[58477, 1611, 347, 9, 42, "Output",ExpressionUUID->"a3c4bfe0-4716-4c50-95e0-3c4a28db8ee4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58861, 1625, 356, 8, 36, "Input",ExpressionUUID->"88bd21d2-1968-4a64-8f0f-8ae09a5e2cb4"],
Cell[59220, 1635, 330, 8, 41, "Output",ExpressionUUID->"75303768-e878-4a50-a5a9-2efcb2c53fd7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59587, 1648, 3027, 68, 295, "Input",ExpressionUUID->"3057f7bf-7e24-40ed-89d0-7df9740770ea"],
Cell[62617, 1718, 876, 16, 36, "Message",ExpressionUUID->"fafac213-35ad-49f9-8b1d-7d96fd3ab8cd"],
Cell[63496, 1736, 878, 16, 36, "Message",ExpressionUUID->"eb66d202-e626-415a-a185-91ee47a4129e"],
Cell[64377, 1754, 964, 17, 36, "Message",ExpressionUUID->"4aa77db2-5c24-430d-8845-8bcbcde50405"],
Cell[65344, 1773, 503, 11, 36, "Message",ExpressionUUID->"b1eff16c-6167-4a85-90ff-524170e65ca9"],
Cell[65850, 1786, 408, 12, 41, "Output",ExpressionUUID->"bbb833ab-6546-4b2e-9d36-674a6d2e48a4"]
}, Open  ]],
Cell[66273, 1801, 154, 3, 36, "Input",ExpressionUUID->"fd99ddcd-d875-42e5-ac2c-812765a39f85"]
}
]
*)

